<%= grid(@users_grid, show_filters: :when_filtered, allow_showing_all_records: false) do |g|

  g.column :name => User.human_attribute_name('email'),
    :attribute => 'email' do |user|
      link_to(user.email, user_path(user))
  end

  if defined?(show_mandator_col) && show_mandator_col
    g.column :name => User.human_attribute_name('mandator'),
      :attribute => 'id', :model => Mandator,
      :custom_filter => Mandator.all.map{|m| [m.name, m.id]} do |user|
        user.mandator.nil? ? '' : link_to(user.mandator.name, mandator_path(user.mandator))
    end
  end

  ['created_at', 'updated_at'].each do |attr|
    g.column :html => {class: 'fdatetime'}, :name => User.human_attribute_name(attr),
      :attribute => attr do |user|
        user[attr].nil? ? '' : l(user[attr], format: :fdatetime)
    end
  end

  g.column :html => {:class => 'boolean'}, :name => User.human_attribute_name('activated'),
    :attribute => 'activated' do |user|
      t(user.activated.to_s)
  end

  g.column :html => {class: 'button'} do |user|
    link_to(image_tag('icons/page_white_show.png'),
      user_path(user), title: t('app.action.show')
    ) + ' ' +
    link_to(image_tag('icons/page_white_edit.png'),
      edit_user_path(user), title: t('app.action.edit')
    ) + ' ' +
    link_to(image_tag('icons/page_white_delete.png'),
      user, title: t('app.action.delete'),
      method: :delete, data: {confirm: t('app.confirm.are_you_sure')}
    )
  end

  if @users_grid.count == 0
    g.last_row do |number_of_columns|
      content_tag(:tr, content_tag(:td,
        t('app.messages.no_records_for_model', :model => User.model_name.human(:count => 2)),
        :colspan => number_of_columns), :class => 'no_records')
    end
  end

end %>
